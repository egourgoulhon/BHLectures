\chapter{SageMath computations} \label{s:sam}

\minitoc

\section{Introduction}


\textsf{SageMath}\index{SageMath} (\url{https://www.sagemath.org/}) is a modern free,
open-source mathematics software system, which is
based on the Python programming language. It makes use of over 90 open-source packages,
among which are \textsf{Maxima}, \textsf{Pynac} and \textsf{SymPy} (symbolic calculations),
\textsf{GAP} (group theory),
\textsf{PARI/GP} (number theory), \textsf{Singular} (polynomial computations),
and \textsf{matplotlib} (high quality 2D figures).
\textsf{SageMath} provides a uniform Python interface to all these packages. However,
\textsf{SageMath} is more than a mere interface: it contains a large and increasing part of
original code (more than 750,000 lines of Python and Cython, involving 5344 classes).
\textsf{SageMath} was created in 2005 by William Stein\index{Stein, W.} \cite{SteinJ05} and since
then its development has been sustained by more than a hundred researchers
(mostly mathematicians). Very good introductory textbooks about \textsf{SageMath} are
\cite{Zimme18,JoyneS14,Bard15}.

The \textsf{SageManifolds}\index{SageManifolds} project (\url{https://sagemanifolds.obspm.fr/})
provides \textsf{SageMath} with capabilities for differential geometry and tensor calculus,
where are used here to perform some computations relative to black hole spacetimes.


There are basically two ways to use \textsf{SageMath}:
\begin{itemize}
\item Install it on your computer, by downloading the sources or a binary version
from \url{https://www.sagemath.org/} (the \textsf{SageManifolds} extensions towards
differential geometry are fully integrated in version 7.5 and higher)
\item Use it online via \textsf{CoCalc}: \url{https://cocalc.com/}
\end{itemize}


The SageMath notebooks (Jupyter format) accompanying these lecture notes are available
at the \textsf{nbviewer.jupyter.org} links provided below.
Clicking on the link leads to a read-only view of the notebook. Then,
by clicking on the \emph{Execute on Binder} button (the three interlaced circles
in the top right menu), one gets access to a freely modifiable and executable version.
All the notebooks are also collected on the page
\begin{center}
\url{https://luth.obspm.fr/~luthier/gourgoulhon/bh16/sage.html}
\end{center}

\section{Minkowski spacetime}

\subsection{Conformal completion of Minkowski spacetime} \label{s:sam:conformal_Mink}

This notebook accompanies Chap.~\ref{s:glo}; in particular, it provides
many figures for Sec.~\ref{s:glo:conf_Mink}.\\[1ex]
{\footnotesize
\url{https://nbviewer.jupyter.org/github/egourgoulhon/BHLectures/blob/master/sage/conformal_Minkowski.ipynb}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Anti-de Sitter spacetime}

\subsection{Poincaré horizon in AdS$_4$ as a degenerate Killing horizon} \label{s:sam:Poincare_hor}

This notebook accompanies Example~\ref{x:neh:AdS} of Chap.~\ref{s:neh}.\\[1ex]
{\footnotesize
\url{https://nbviewer.jupyter.org/github/sagemanifolds/SageManifolds/blob/master/Notebooks/SM_anti_de_Sitter_Poincare_hor.ipynb}
}

\subsection{Conformal completion of AdS$_4$}  \label{s:sam:AdS}

This notebook introduces AdS$_4$ in various coordinate systems and provides
the figure of Example~\ref{x:glo:AdS} in Chap.~\ref{s:glo}.\\[1ex]
{\footnotesize
\url{https://nbviewer.jupyter.org/github/sagemanifolds/SageManifolds/blob/master/Notebooks/SM_anti_de_Sitter.ipynb}
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Schwarzschild spacetime}

\subsection{The Schwarzschild horizon} \label{s:sam:Schwarz_hor}

This notebook accompanies Chap.~\ref{s:def} in treating the future event horizon of
Schwarzschild spacetime in Eddington-Finkelstein coordinates as an example of null hypersurface:\\[1ex]
{\footnotesize
\url{https://nbviewer.jupyter.org/github/egourgoulhon/BHLectures/blob/master/sage/Schwarzschild_horizon.ipynb}
}


\subsection{Solving Einstein equation: Kottler solution} \label{s:sam:Kottler_solution}

This notebook accompanies Chap.~\ref{s:sch}: it computes the Kottler solution by solving the Einstein
equation for vacuum spherically symmetric spacetimes with a cosmological constant $\Lambda$,
yielding Schwarzschild solution in the special case $\Lambda=0$. \\[1ex]
{\footnotesize
\url{https://nbviewer.jupyter.org/github/egourgoulhon/BHLectures/blob/master/sage/Kottler_solution.ipynb}
}

\subsection{Kretschmann scalar of Schwarzschild spacetime} \label{s:sam:Kretschmann_Schwarz}

This notebook accompanies Chap.~\ref{s:sch}: it computes the Riemann curvature
tensor of Schwarzschild metric and evaluates the Kretschmann scalar as defined
by Eq.~(\ref{e:sch:def_Kretschmann}). \\[1ex]
{\footnotesize
\url{https://nbviewer.jupyter.org/github/sagemanifolds/SageManifolds/blob/master/Notebooks/SM_basic_Schwarzschild.ipynb}
}

\subsection{Radial null geodesics in Schwarzschild spacetime}

This notebook accompanies Chap.~\ref{s:sch}: it provides figures based on
Schwarzschild-Droste coordinates and ingoing Eddington-Finkelstein coordinates.\\[1ex]
{\footnotesize
\url{https://nbviewer.jupyter.org/github/egourgoulhon/BHLectures/blob/master/sage/Schwarz_radial_null_geod.ipynb}
}

\subsection{Radial timelike geodesics in Schwarzschild spacetime} \label{s:sam:ges_radial_free_fall}

This notebook accompanies Chap.~\ref{s:ges}: it provides
figures as well as the computation of
the integral leading to
of Eq.~(\ref{e:ges:sol_t_radial_infall}).\\[1ex]
{\footnotesize
\url{https://nbviewer.jupyter.org/github/egourgoulhon/BHLectures/blob/master/sage/ges_radial_free_fall.ipynb}
}

\subsection{Timelike orbits in Schwarzschild spacetime} \label{s:sam:ges_orbits}
%
This notebook accompanies Chap.~\ref{s:ges}: it provides
figures of timelike orbits in the equatorial plane.\\[1ex]
{\footnotesize
\url{https://nbviewer.jupyter.org/github/egourgoulhon/BHLectures/blob/master/sage/ges_orbits.ipynb}
}

\subsection{Effective potential for null geodesics in Schwarzschild spacetime} \label{s:sam:ges_eff_pot_null}
%
This notebook accompanies Chap.~\ref{s:gis}, providing the plot of the
effective potential $U(r)$.\\[1ex]
{\footnotesize
\url{https://nbviewer.jupyter.org/github/egourgoulhon/BHLectures/blob/master/sage/ges_effective_potential_null.ipynb}
}

\subsection{Null geodesics in Schwarzschild spacetime} \label{s:sam:ges_null_geod}
%
This notebook accompanies Chap.~\ref{s:gis}, computing and plotting various
null geodesics.\\[1ex]
{\footnotesize
\url{https://nbviewer.jupyter.org/github/egourgoulhon/BHLectures/blob/master/sage/ges_null_geod.ipynb}
}

\subsection{Periastron and apoastron of null geodesics in Schwarzschild spacetime} \label{s:sam:ges_null_periastron}
%
This notebook accompanies Chap.~\ref{s:gis}, computing periastrons and apoastrons
along null geodesics.\\[1ex]
{\footnotesize
\url{https://nbviewer.jupyter.org/github/egourgoulhon/BHLectures/blob/master/sage/ges_null_periastron.ipynb}
}

\subsection{Critical null geodesics in Schwarzschild spacetime} \label{s:sam:ges_null_critical_geod}
%
This notebook accompanies Chap.~\ref{s:gis}, plotting critical null geodesics.\\[1ex]
{\footnotesize
\url{https://nbviewer.jupyter.org/github/egourgoulhon/BHLectures/blob/master/sage/ges_null_critical_geod.ipynb}
}

\subsection{Elliptic integrals for null geodesics in Schwarzschild spacetime} \label{s:sam:gis_elliptic_int}
%
This notebook accompanies Chap.~\ref{s:gis}, computing the trace of null
geodesics in the equatorial plane via elliptic integrals.\\[1ex]
{\footnotesize
\url{https://nbviewer.jupyter.org/github/egourgoulhon/BHLectures/blob/master/sage/gis_elliptic_int.ipynb}
}

\subsection{Null geodesics in Schwarzschild spacetime with $b<b_{\rm c}$} \label{s:sam:gis_paramaters_b_lt_bc}
%
This notebook accompanies Chap.~\ref{s:gis}, computing various quantities that
are relevant for null geodesics with an impact parameter lower than the critical one.\\[1ex]
{\footnotesize
\url{https://nbviewer.jupyter.org/github/egourgoulhon/BHLectures/blob/master/sage/gis_paramaters_b_lt_bc.ipynb}
}

\subsection{Multiple images in Schwarzschild spacetime} \label{s:sam:ges_null_images}
%
This notebook accompanies Chap.~\ref{s:gis}, computing null geodesics that
depart in a fixed direction (the observer one).\\[1ex]
{\footnotesize
\url{https://nbviewer.jupyter.org/github/egourgoulhon/BHLectures/blob/master/sage/ges_null_images.ipynb}
}

\subsection{Emission from a point source in Schwarzschild spacetime} \label{s:sam:gis_emission}
%
This notebook accompanies Chap.~\ref{s:gis}, computing quantities related to the
emission by a static observer.\\[1ex]
{\footnotesize
\url{https://nbviewer.jupyter.org/github/egourgoulhon/BHLectures/blob/master/sage/gis_emission.ipynb}
}

\subsection{Images of an accretion disk around a Schwarzschild black hole} \label{s:sam:gis_disk_image}
%
This notebook accompanies Chap.~\ref{s:gis}, computing null geodesics illustrating the formation of images of an accretion disk.\\[1ex]
{\footnotesize
\url{https://nbviewer.jupyter.org/github/egourgoulhon/BHLectures/blob/master/sage/gis_disk_image.ipynb}
}

\subsection{Kruskal-Szekeres coordinates in Schwarzschild spacetime} \label{s:sam:Schwarz_Kruskal_Szekeres}

This notebook accompanies Chap.~\ref{s:max}: it provides the figures based on
Kruskal-Szekeres coordinates.\\[1ex]
{\footnotesize
\url{https://nbviewer.jupyter.org/github/egourgoulhon/BHLectures/blob/master/sage/Schwarz_Kruskal_Szekeres.ipynb}
}

\subsection{Standard (singular) Carter-Penrose diagram of Schwarzschild spacetime}
\label{s:sam:Schwarz_conformal_std}
This notebook accompanies Chap.~\ref{s:max}: it provides the standard
Carter-Penrose diagram shown in Fig.~\ref{f:max:carter-penrose-std}.\\[1ex]
{\footnotesize
\url{https://nbviewer.jupyter.org/github/egourgoulhon/BHLectures/blob/master/sage/Schwarz_conformal_std.ipynb}
}

\subsection{Regular Carter-Penrose diagram of Schwarzschild spacetime}
\label{s:sam:Schwarz_conformal}
This notebook accompanies Chap.~\ref{s:max}: it provides the regular
Carter-Penrose diagram shown in Fig.~\ref{f:max:carter-penrose-FN}.\\[1ex]
{\footnotesize
\url{https://nbviewer.jupyter.org/github/egourgoulhon/BHLectures/blob/master/sage/Schwarz_conformal.ipynb}
}

\subsection{Einstein-Rosen bridge in Schwarzschild spacetime}
\label{s:sam:Einstein-Rosen_bridge}
This notebook accompanies Chap.~\ref{s:max}: it provides the
isometric embedding diagrams shown in Figs.~\ref{f:max:flamm_paraboloid}
to \ref{f:max:flamm_paraboloid_far}, as well as the associated
Kruskal diagram of Fig.~\ref{f:max:constant_T_slices}.\\[1ex]
{\footnotesize
\url{https://nbviewer.jupyter.org/github/egourgoulhon/BHLectures/blob/master/sage/Einstein-Rosen_bridge.ipynb}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Kerr spacetime}

\subsection{Kerr metric as a solution of Einstein equation} \label{s:sam:Kerr_solution}

This notebook accompanies Chap.~\ref{s:ker}: the Kerr metric, expressed in Boyer-Lindquist
coordinates, is shown to be a solution of the vacuum Einstein equation. Moreover, the Kretschmann scalar is computed.\\[1ex]
{\footnotesize
\url{https://nbviewer.jupyter.org/github/egourgoulhon/BHLectures/blob/master/sage/Kerr_solution.ipynb}
}

\subsection{Kerr spacetime in Kerr coordinates} \label{s:sam:Kerr_Kerr_coord}

This notebook accompanies Chap.~\ref{s:ker}: the Kerr metric is expressed in Kerr coordinates, the vacuum Einstein equation is checked, the outgoing and ingoing principal null geodesics are considered and the black hole surface gravity is computed.\\[1ex]
{\footnotesize
\url{https://nbviewer.jupyter.org/github/egourgoulhon/BHLectures/blob/master/sage/Kerr_in_Kerr_coord.ipynb}
}

\subsection{Plot of principal null geodesics in Kerr spacetime} \label{s:sam:Kerr_princ_null_geod}

This notebook provides some figures for Chap.~\ref{s:ker}.\\[1ex]
{\footnotesize
\url{https://nbviewer.jupyter.org/github/egourgoulhon/BHLectures/blob/master/sage/Kerr_princ_null_geod.ipynb}
}


\subsection{Kerr-Schild coordinates on Kerr spacetime} \label{s:sam:Kerr_Schild}

This notebook accompanies Appendix~\ref{s:ksm}: the Kerr metric is expressed in
a Kerr-Schild form and Kerr-Schild coordinates are introduced.\\[1ex]
{\footnotesize
\url{https://nbviewer.jupyter.org/github/egourgoulhon/BHLectures/blob/master/sage/Kerr_Schild.ipynb}
}

\subsection{ZAMO frame on Kerr spacetime} \label{s:sam:Kerr_ZAMO_frame}

This notebook accompanies Chap.~\ref{s:ker}, providing various formulas relative to
the orthonormal frame carried by a Zero-angular-momentum observer (ZAMO).\\[1ex]
{\footnotesize
\url{https://nbviewer.jupyter.org/github/egourgoulhon/BHLectures/blob/master/sage/Kerr_ZAMO_frame.ipynb}
}

\subsection{Carter frame on Kerr spacetime} \label{s:sam:Kerr_Carter_frame}

This notebook accompanies Chap.~\ref{s:ker}, providing various formulas relative to
the orthonormal frame carried by a Carter observer.\\[1ex]
{\footnotesize
\url{https://nbviewer.jupyter.org/github/egourgoulhon/BHLectures/blob/master/sage/Kerr_Carter_frame.ipynb}
}


\subsection{Walker-Penrose Killing tensor on Kerr spacetime} \label{s:sam:Kerr_Killing_tensor}

This notebook accompanies Chap.~\ref{s:gek}; it shows that the
tensor $\w{K}$ defined by Eq.~(\ref{e:gek:def_K}) is actually a Killing tensor.\\[1ex]
{\footnotesize
\url{https://nbviewer.jupyter.org/github/egourgoulhon/BHLectures/blob/master/sage/Kerr_Killing_tensor.ipynb}
}


\subsection{Timelike and null geodesics in Kerr spacetime} \label{s:sam:Kerr_geod_plots}

This notebook accompanies Chap.~\ref{s:gek}, computing and plotting null and timelike geodesics.\\[1ex]
{\footnotesize
\url{https://nbviewer.jupyter.org/github/egourgoulhon/BHLectures/blob/master/sage/Kerr_geod_plots.ipynb}
}

\subsection{Circular equatorial orbits in Kerr spacetime} \label{s:sam:Kerr_circular_orbits}

This notebook provides some figures for Chap.~\ref{s:gek}.\\[1ex]
{\footnotesize
\url{https://nbviewer.jupyter.org/github/egourgoulhon/BHLectures/blob/master/sage/Kerr_circular_orbits.ipynb}
}

\subsection{Zero-energy null geodesics in Kerr spacetime} \label{s:sam:Kerr_null_geod_zero_ener}

This notebook provides some figures for Chap.~\ref{s:gik}.\\[1ex]
{\footnotesize
\url{https://nbviewer.jupyter.org/github/egourgoulhon/BHLectures/blob/master/sage/Kerr_null_geod_zero_ener.ipynb}
}

\subsection{Existence and stability of spherical photon orbits in Kerr spacetime} \label{s:sam:Kerr_spher_photon_existence}

This notebook provides some figures for Chap.~\ref{s:gik}.\\[1ex]
{\footnotesize
\url{https://nbviewer.jupyter.org/github/egourgoulhon/BHLectures/blob/master/sage/Kerr_spher_photon_existence.ipynb}
}

\subsection{Plots of spherical photon orbits geodesics in Kerr spacetime}
\label{s:sam:Kerr_spher_null_geod}

This notebook provides some figures for Chap.~\ref{s:gik}.\\[1ex]
{\footnotesize
\url{https://nbviewer.jupyter.org/github/egourgoulhon/BHLectures/blob/master/sage/Kerr_spher_null_geod.ipynb}
}

\subsection{Plots of null geodesics in Kerr spacetime} \label{s:sam:Kerr_null_geod_plots}

This notebook provides some figures for Chap.~\ref{s:gik}.\\[1ex]
{\footnotesize
\url{https://nbviewer.jupyter.org/github/egourgoulhon/BHLectures/blob/master/sage/Kerr_null_geod_plots.ipynb}
}

\subsection{Shadow and critical curve of a Kerr black hole} \label{s:sam:Kerr_shadow}

This notebook provides some figures for Chap.~\ref{s:gik}.\\[1ex]
{\footnotesize
\url{https://nbviewer.jupyter.org/github/egourgoulhon/BHLectures/blob/master/sage/Kerr_shadow.ipynb}
}

\subsection{Images of an accretion disk around a Kerr black hole} \label{s:sam:Kerr_images}

This notebook provides some figures for Chap.~\ref{s:gik}.\\[1ex]
{\footnotesize
\url{https://nbviewer.jupyter.org/github/egourgoulhon/BHLectures/blob/master/sage/Kerr_images.ipynb}
}

\subsection{Critical curve of a Kerr black hole onto the EHT image of M87*} \label{s:sam:Kerr_image_M87}

This notebook generates Fig.~\ref{f:gik:M87_EHT_crit}.\\[1ex]
{\footnotesize
\url{https://nbviewer.jupyter.org/github/egourgoulhon/BHLectures/blob/master/sage/Kerr_image_M87.ipynb}
}


\subsection{Extremal Kerr spacetime} \label{s:sam:Kerr_extremal}

This notebook accompanies Chap.~\ref{s:exk}.\\[1ex]
{\footnotesize
\url{https://nbviewer.jupyter.org/github/egourgoulhon/BHLectures/blob/master/sage/Kerr_extremal.ipynb}
}

\subsection{Maximal extension of the extremal Kerr spacetime} \label{s:sam:Kerr_extremal_extended}

This notebook accompanies Chap.~\ref{s:exk}.\\[1ex]
{\footnotesize
\url{https://nbviewer.jupyter.org/github/egourgoulhon/BHLectures/blob/master/sage/Kerr_extremal_extended.ipynb}
}

\subsection{Isometric embbedings of $(t,\th)$ sections of the extremal Kerr spacetime} \label{s:sam:Kerr_extremal_throat_emb}

This notebook accompanies Chap.~\ref{s:exk}.\\[1ex]
{\footnotesize
\url{https://nbviewer.jupyter.org/github/egourgoulhon/BHLectures/blob/master/sage/Kerr_extremal_throat_emb.ipynb}
}

\subsection{Near-horizon extremal Kerr geometry} \label{s:sam:NEHK}

This notebook accompanies Chap.~\ref{s:exk}.\\[1ex]
{\footnotesize
\url{https://nbviewer.jupyter.org/github/sagemanifolds/SageManifolds/blob/master/Notebooks/SM_extremal_Kerr_near_horizon.ipynb}
}

\subsection{NHEK spacetime} \label{s:sam:NEHK_spacetime}

This notebook accompanies Chap.~\ref{s:exk}.\\[1ex]
{\footnotesize
\url{https://nbviewer.jupyter.org/github/egourgoulhon/BHLectures/blob/master/sage/NHEK_spacetime.ipynb}
}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Evolution and thermodynamics}

\subsection{Lemaître-Tolman equations} \label{s:sam:Lemaitre_Tolman}

This notebook accompanies Chap.~\ref{s:lem}: it provides the derivation
of the Lemaître-Tolman equations from the Einstein equation expressed in
Lemaître synchronous coordinates.\\[1ex]
{\footnotesize
\url{https://nbviewer.jupyter.org/github/egourgoulhon/BHLectures/blob/master/sage/Lemaitre_Tolman.ipynb}
}

\subsection{Oppenheimer-Snyder collapse: spacetime diagrams} \label{s:sam:Oppenheimer_Snyder}

This notebook generates some figures for Chap.~\ref{s:lem}.\\[1ex]
{\footnotesize
\url{https://nbviewer.jupyter.org/github/egourgoulhon/BHLectures/blob/master/sage/Oppenheimer_Snyder.ipynb}
}

\subsection{Oppenheimer-Snyder collapse: curvature} \label{s:sam:Oppenheimer_Snyder_curvature}

This notebook accompanies Chap.~\ref{s:lem}: it evaluates the curvature tensor and some
associated scalars.\\[1ex]
{\footnotesize
\url
{https://nbviewer.jupyter.org/github/egourgoulhon/BHLectures/blob/master/sage/Oppenheimer_Snyder_curvature.ipynb}
}


\subsection{Vaidya spacetime} \label{s:sam:Vaidya}

This notebook accompanies Chaps.~\ref{s:vai} and \ref{s:loc}: the Vaidya metric is expressed in Eddington-Finkelstein coordinates, the Einstein equation is checked, the outgoing and ingoing radial null geodesics are computed and the trapping horizon and the event
horizon are drawn in a spacetime diagram. \\[1ex]
{\footnotesize
\url{https://nbviewer.jupyter.org/github/egourgoulhon/BHLectures/blob/master/sage/Vaidya.ipynb}
}

\subsection{Solving the ODE for outgoing radial null geodesics in Vaidya spacetime} \label{s:sam:Vaidya_solve_ode_out}

This notebook accompanies Chap.~\ref{s:vai}. \\[1ex]
{\footnotesize
\url{https://nbviewer.jupyter.org/github/egourgoulhon/BHLectures/blob/master/sage/Vaidya_solve_ode_out.ipynb}
}
\subsection{Naked singularity in Vaidya collapse} \label{s:sam:Vaidya_nk_sing}

This notebook accompanies Chap.~\ref{s:vai}; it corresponds to the case where a
naked singularity appears in the collapse of a radaition shell. \\[1ex]
{\footnotesize
\url{https://nbviewer.jupyter.org/github/egourgoulhon/BHLectures/blob/master/sage/Vaidya_nk_sing.ipynb}
}

